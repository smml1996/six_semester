{% extends 'base.html' %}
{% load staticfiles %}
{% block content %}

<div class="container" style="margin-top: 15vh;">
  <div class="row justify-content-center" style="margin-bottom:2em;">
    <h3>Current Savings: {{ currentSaving }}  </h3>
  </div>
  <div class="row justify-content-center">
    <!-- begin: input date from -->
      <div class="form-group text-center col-8 col-sm-8 col-md-4 col-lg-4">
        <div class="input-group mb-3">
          <div class="input-group-prepend">
            <span class="input-group-text" id="basic-addon1">
              <i class="fas fa-calendar-alt"></i>
            </span>
          </div>
          <input id="from-date" type="text" name="from" value="{{ todayDate }}" class="form-control" placeholder="from"/>
        </div>
      </div>
      <!-- end: input date from -->

      <!-- begin: input date to -->
      <div class="form-group text-center col-8 col-sm-6 col-md-4 col-lg-4">
        <div class="input-group mb-3">
          <div class="input-group-prepend">
            <span class="input-group-text" id="basic-addon1">
              <i class="fas fa-calendar-alt"></i>
            </span>
          </div>
          <input id="to-date" type="text" name="to" value="{{ todayDate }}" class="form-control" placeholder="to"/>
        </div>
      </div>
      <!-- end: input date to -->


      <!-- begin: button visualize incomes -->
      <div class="col-5 col-md-8 col-lg-8 col-sm-5 justify-content-center text-center" style="margin-top:5vh;">
        <button role="button" onclick="loadIncomes(event)" class="btn btn-primary">Visualize Incomes</button>
      </div>
      <!-- end: button visualize incomes -->


      <!-- begin: button visualize expenses -->
      <div class="col-5 col-md-8 col-lg-8 col-sm-5 justify-content-center text-center" style="margin-top:5vh;">
        <button  role="button" onclick="loadExpenses(event)" class="btn btn-primary">Visualize Expenses</button>
      </div>
      <!-- end: button visualize expenses -->

      <!-- begin: summary -->
      <div class="col-5 col-md-8 col-lg-8 col-sm-5 justify-content-center " style="margin-top:5vh; ">
      <div class="card" style="width: 40vw;margin-left:auto; margin-right:auto;">
        <div class="card-body">
          <h5 class="card-title">Summary</h5>
          <p class="card-text text-center">All year: <span id="all-year"> 0.00</span></p>
            <p class="card-text text-center">Month: <span id="all-month"> 0.00</span></p>
        </div>
      </div>
    </div>
    <!-- end: summary -->
  </div>
</div>


<script>
    $(document).ready(function(){
      // getting date input from
      var date_input=$('input[name="from"]');

      // getting calendar's container
      var container=$('.bootstrap-iso form').length>0 ? $('.bootstrap-iso form').parent() : "body";
      // stablishing calendar's input options
      var options={
        format: 'mm/dd/yyyy',
        container: container,
        todayHighlight: true,
        autoclose: true,
      };

      //initialiazing date input from
      date_input.datepicker(options);

      // getting date input to
      var date_input2 = $('input[name="to"]');
      //initialiazing date input to
      date_input2.datepicker(options)
    })


    function loadIncomes(event){
      $.ajax({
        type: "GET",
        url:"{% url 'visualize' %}",
        dataType: "json",
        async:true, // keep front end responsive to user input
        data:{
          from: $("#from-date").val(),
          to: $("#to-date").val(),
          type: 1
        },
        success: function(data){

          console.log(data);
        },
        error: function(){


        }
      })
    }

    function loadExpenses(event){
      $.ajax({
        type: "GET",
        url:"{% url 'visualize' %}",
        dataType: "json",
        async:true, // keep front end responsive to user input
        data:{
          csrfmiddlewaretoken:'{{ csrf_token }}',
          from: $("#from-date").val(),
          to: $("to-date").val(),
          type: 0
        },
        success: function(data){

          console.log(data);
        },
        error: function(){

        }
      })

    }
</script>

{% endblock content %}
